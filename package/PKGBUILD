# Maintainer: deneme <deneme@deneme.domain>
pkgname="eta-touchdrv"
pkgver="0.2.0"
pkgrel="1"
pkgdesc="Touchscreen driver for Vestel 14MB24A (IRTOUCH)"
arch=("any")
url="https://github.com/abdullah-rgb/eta-touchdrv"
license=("custom")
# depends=(git linux linux-headers)
# makedepends=(base-devel dkms usbutils systemd)
checkdepends=()
optdepends=('touchegg: Touchscreen configuraton'
            'touche: Touchscreen configuraton tool')

prepare() {
	git clone "${url}"

        cd ${pkgname}

        sudo cp -rv usr/src/eta-touchdrv /usr/src/
        sudo cp -rv usr/lib/systemd/system/* /usr/lib//systemd/system/
}

build() {
	cd /usr/src/${pkgname}
	cd touch2/
	sudo make
	sudo insmod OpticalDrv.ko
	cd ../touch4
	sudo make
	sudo insmod OtdDrv.ko
	cd ../
	sudo dkms install .

	mkdir -p "${srcdir}/package/usr/src" "${srcdir}/package/usr/bin" "${srcdir}/package/usr/share" "${srcdir}/package/usr/lib"
	cp -rv "/usr/src/eta-touchdrv" "${srcdir}/package/usr/src/"
	cp -rv "${srcdir}/eta-touchdrv/usr/bin" "${srcdir}/package/usr/bin"
	cp -rv "${srcdir}/eta-touchdrv/usr/lib" "${srcdir}/package/usr/lib"
	cp -rv "${srcdir}/eta-touchdrv/usr/share" "${srcdir}/package/usr/share"
}

package() {
	# cp -rv "${srcdir}/eta-touchdrv/usr" "${pkgdir}"
	cp -rv "${srcdir}/package/usr" "${pkgdir}"
}
